# Configuration

This guide lists the configuration surfaces that influence how `menv` provisions a machine.

## Environment Variables
The root `.env.example` captures required secrets and identity values. Copy it to `.env` (done automatically by `make base`) and provide values before running Just recipes.

| Variable | Purpose |
| --- | --- |
| `PERSONAL_VCS_NAME`, `PERSONAL_VCS_EMAIL` | Applied by `just sw-p` to Git (`~/.config/git/config`) and JJ (`~/.config/jj/config.toml`). |
| `WORK_VCS_NAME`, `WORK_VCS_EMAIL` | Applied by `just sw-w`. Leave blank if you only use the personal profile. |
| `MENV_GITHUB_PAT` | Token consumed by MCP GitHub tooling shipped with the shell aliases and AI agents. |

`.env` is never committed, but its values are exported whenever `_run_ansible` executes.

## Ansible Role Configuration
Role configuration lives under `ansible/roles/<role>/config/`. Common patterns include:
- **Version pins:** `.python-version`, `.ruby-version`, `.rust-version`, `.nvmrc` govern runtime installations.
- **Package manifests:** `brew/config/common/formulae/Brewfile`, `nodejs/config/common/global-packages.json`, `python/config/common/pipx-tools.yml`, `rust/config/common/tools.yml`, `docker/config/common/images.txt` enumerate packages and images.
- **Editor settings:** `editor/config/common/settings.json`, `keybindings.json`, `vscode-extensions.json`, `cursor-extensions.json` define IDE defaults.
- **System defaults:** `system/config/common/system.yml` (generated by the backup script) and `definitions/*.yml` describe macOS preferences.
- **SSH and VCS dotfiles:** `ssh/config/common/config`, `conf.d/*.conf`, `vcs/config/common/git/.gitconfig`, `jj/config.toml`.

When profile-specific overrides exist (for example `brew/config/profiles/mac-mini/cask/Brewfile`), tasks use Ansibleâ€™s `first_found` lookup to fall back to the shared `common` version.

## AI Tools
Several roles ship configuration for AI-powered tooling:
- **Claude Code (`just claude`):** `nodejs/config/common/llm/claude.json` controls CLI behavior, telemetry defaults, and MCP permissions. Prompt assets under `slash/config/common/commands` are symlinked into `~/.local/slash`.
- **Gemini CLI (`just gemini`):** `nodejs/config/common/llm/gemini.json` defines model selection, privacy settings, and context handling. The role also warns if the CLI is unavailable after installation.
- **Codex CLI (`just codex`):** `nodejs/config/common/llm/codex.toml` specifies model, provider, sandbox mode, and approval policy.
- **Aider (`just aider`):** `python/config/common/aider/.aider.conf.yml` and `.aider.model.settings.yml` pin models and runtime parameters, while the role installs `aider-chat` via `pipx`.
- **Slash commands (`just slash`):** `slash/config/common/config.json` maps slash command IDs to prompts, and generator scripts in `ansible/scripts/slash/` regenerate agent commands.

These files live in the repository so you can version control changes to AI workflows alongside the rest of the environment.
