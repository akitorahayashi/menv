# Agent Skills 実装・仕様ガイド

## 1. Agent Skills とは

**Agent Skills**（エージェントスキル）は、AIコーディングエージェントに対して「特定の専門知識」や「実行手順」を外部モジュールとして提供する仕組みです。

* **目的**: プロジェクト固有のルール（CIのデバッグ手順、認証監査など）や、定型作業をAIに教え込み、自律的なタスク遂行能力を拡張する。
* **標準構造 (Open Agent Skills Standard)**:
多くのツールが以下の標準的なディレクトリ構造をサポートしています 。


```text
skill-name/
├── SKILL.md            # [必須] スキルの定義（プロンプト、手順）
├── scripts/            # [任意] 実行可能なスクリプト
└── agents/             # [任意] 特定ツール向けのメタデータ (openai.yaml等)

```



## 2. 変更の目的：SSOTと共通化

これまではツールごとに個別のスキル管理が必要でしたが、`menv` では **Single Source of Truth (SSOT)** アプローチを採用します。

* **現状**: Codex, Claude, Gemini で別々にスキルを管理・配置する必要がある。
* **変更後**: `menv` リポジトリ内の **一箇所の定義 (`common/coder/skills`)** を、Ansible を通じて全ツールの設定パスへ展開する。
* **メリット**: `SKILL.md` を一つ書けば、全てのAIエージェントがその能力を獲得する「ポータブルなスキル」を実現する。

## 3. 各プラットフォームの仕様

実装においてターゲットとなる各CLIツールの仕様は以下の通りです。

### 3.1. Codex CLI

* 
**スキル配置パス**: `~/.codex/skills/` 


* 
**認識挙動**: 起動時に自動発見。シンボリックリンクされたディレクトリも追跡可能 。


* **特徴**: `agents/openai.yaml` があるとUI表示名などをカスタマイズ可能だが、必須ではない。

### 3.2. Anthropic Claude Code

* 
**スキル配置パス**: `~/.claude/skills/` 


* 
**認識挙動**: ファイルシステムベースで管理され、配置されたディレクトリを自動で読み込む 。


* **留意点**: 設定ファイル（`config.json`）等で機能が許可されている必要がある場合がありますが、配置自体はディレクトリベースで行います。

### 3.3. Google Gemini CLI

* 
**スキル配置パス**: `~/.gemini/skills/` （ユーザーグローバル領域） 


* **認識挙動**: ワークスペース固有（`.gemini/skills`）とユーザー共通（`~/.gemini/skills`）の両方を読み込む。今回の計画ではユーザー共通領域を使用。
* 
**コマンド**: `/skills list` 等で認識状況を確認可能 。



## 4. 実装要件まとめ

### リポジトリ構成 (Source)

`src/menv/ansible/roles/nodejs/config/common/coder/skills/` 配下に、ツールに依存しないフラットなスキルディレクトリを作成します。

### Ansible タスク挙動 (Deploy)

`coder.yml` にて以下の処理を実装します：

1. **ディレクトリ作成**: `~/.codex/skills`, `~/.claude/skills`, `~/.gemini/skills` を確保。
2. **クロス展開**: SSOTにある各スキルフォルダ（例: `ci-helper`）を、上記3つのパス全てに対してシンボリックリンク (`ln -s`) で配置。

これにより、実装者は「1つのスキルディレクトリ」をメンテナンスするだけで、全プラットフォームへの対応を完了できます。