schema_version: 1

# Metadata
id: "ev7g8h"
issue_id: "a1r2ch"
created_at: "2024-05-23"
author_role: "pythonista"
confidence: "medium"

# Content
title: "Business Logic Leaking into CLI Command"
statement: |
  The `make` command (`src/menv/commands/make.py`) implements core business logic in private helper functions.
  `_get_roles_for_tags` and `_deploy_configs_for_roles` perform domain logic (mapping tags to roles, conditional deployment) that should reside in the service layer (e.g., `Playbook` or `ConfigDeployer` services).
  This violation of separation of concerns makes the logic harder to reuse and test in isolation.

# Evidence supporting the observation
evidence:
  - path: "src/menv/commands/make.py"
    loc:
      - "33-63"
    note: "Private helper functions implementing domain logic inside the command module."

tags:
  - "anti-pattern"
  - "architecture"
  - "separation-of-concerns"
