---
version: "1"
git_protocol: ssh
prompt: disabled
spinner: enabled
aliases:
  # gh organization aliases
  or: org
  or-ls: org list
  # gh branch aliases
  br-df: |
    !f() {
      local base_branch="${1:-main}"
      local target_branch="${2:-HEAD}"
      echo "=== DIFF CONTEXT ==="
      echo "Base: $base_branch"
      echo "Target: $target_branch"
      echo "Repository: $(basename $(git rev-parse --show-toplevel))"
      echo "=== CHANGES ==="
      git diff "$base_branch...$target_branch"
    }; f "$@"
  # gh PR aliases (gho handles list, these handle mutation)
  pr-ct: |
    !f() {
      local pr_id="$1"
      if [ -z "$pr_id" ]; then
        echo "Usage: gh pr-ds <pr-number>" >&2
        return 1
      fi
      gh pr view "$pr_id" --json comments --jq '.comments[] | "[\(.author.login)] \(.body)"'
    }; f "$@"
  pr-mr: |
    !f() {
      local pr_id="$1"
      if [ -z "$pr_id" ]; then
        echo "Usage: gh pr-mr <pr-number>" >&2
        return 1
      fi
      local mergeable
      mergeable=$(gh pr view "$pr_id" --json mergeable --jq ".mergeable")
      if [ "$mergeable" = "MERGEABLE" ]; then
        echo "PR #$pr_id is MERGEABLE. Merging..."
        gh pr merge "$pr_id"
      else
        echo "PR #$pr_id is not mergeable: $mergeable"
        return 2
      fi
    }; f "$@"
